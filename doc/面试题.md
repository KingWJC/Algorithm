# 编程习惯

自然需求都是模糊的，条件很少，需要编程人员讨论出更加精细的标准和进一步的边界条件。

# UUID的系统的设计

设计一个生成UUID的系统，给全球所有人用，负责生成全球唯一的编号，吞吐量很大，比如给沙漠的每一粒沙子记编号。

要求，编号必须唯一，碰撞概率为0，适用于大吞吐量

**分析**

不用SHA256，SHA1，md5算法，因为哈希算法碰撞概率不是0

垂直扩展的设计技巧：控制上下层服务的沟通频率。不跨级申请。

1. 需要一台主机，多台从机，只同步1个变量的数据：base编号，记录当前给到多少号，是long类型。如17万亿

2. 如果中国区域服务器申请编号，当前编号的最小值是17万亿，则返回两个值：base最小值和一个区间range=500亿，服务器的base更新为17万亿+500亿。

3. 根据编号申请的频率，调大返回的区间。压力化为range，减少频繁申请。

4. 然后中国下又分各个省的服务器，每个服务器向上申请编号，得到一个最小值加Range

5. 如果省级服务器挂掉，加从机备份，或者直接申请新的，之前的丢弃。

6. 而且主机和从机的同步很容易，因为数据量小，更新不频繁。